---
title: "Productivity Model Equations"
author: "J.R. Blaszczak, C.B. Yackulic, R.O. Hall, Jr."
output: html_document
---


### Productivity Model 1: Linear autoregressive model

We first predict the temporal dynamics of daily estimates of GPP ($g$) using a linear autoregressive model without latent biomass dynamics. We fit the model to the $g$ times series from Appling et al. (2018) to estimate the parameters described below:

\begin{equation} 
G_{t} \sim N(\phi G_{(t-\Delta t)}+\alpha L_{t}+\beta Q_{t}, \sigma_{proc})
\end{equation}

\begin{equation} 
g_{t} \sim N(e^{G_{t}},\sigma_{obs})
\end{equation}

where input data includes the daily mean of the posterior probability distribution of previously modeled daily GPP time series ($GPP_{mod,t}$; $g\ O_{2}\ m^{-2}\ d^{-1}$), $L$ which is daily light at time $t$ relativized to the annual maximum daily light (unitless; 0<$L$<1), and $Q_t$ which is daily discharge at time $t$ normalized by subtracting the mean and dividing by the standard deviation ($m^{3} s^{-1}$). Estimated parameters include $G_{pred,t}$ which is the predicted daily GPP (g $O_2$ $m^{-2}$ $d^{-1}$) at time $t$ (in days) on a natural log scale, $\phi$ which is the estimated autoregressive parameter (unitless; 0<$\phi$<1), $\alpha$ which is a GPP increase as a function of light parameter (g $O_2$ $m^{-2}$ $d^{-1}$), $\beta$ which is a GPP reduction per unit discharge parameter ($\frac{g\ O_{2}\ m^{-2}\ d^{-1}}{m^{3} s^{-1}}$), $\sigma_{obs}$ which is the observation error set to the standard deviation of the posterior probability distribution of the previously modeled daily GPP estimates, $\sigma_{proc}$ which is the process error.

### Productivity Model 2: Latent biomass logistic growth
We predict the temporal dynamics of mean daily estimates of GPP ($g$) by incorporating biomass as a latent variable and modeling its dynamics using a logistic growth model. We fit the model to the $g$ times series from Appling et al. (2018) to estimate the model parameters. We incorporated the effects of disturbance by modeling the persistence ($P$) of biomass using a complementary log-log link function of the form:
\begin{equation}
    P_{t} = e^{-e^{s*(Q_{t} - c)}}
\end{equation}

where input data includes $Q_t$ which is daily discharge at time $t$ normalized by subtracting the mean and dividing by the standard deviation ($m^{3} s^{-1}$). Estimated parameters include $s$ which is a parameter that characterizes the steepness of the persistence transition and $c$ is an estimated parameter which approximates the critical discharge at which autotrophic biomass is disturbed. The log-log link function constrains values between 0 and 1, where 0 is no persistence and 1 is complete persistence.

Together, the full model took the form:

\begin{equation}
    B_{t} \sim N(P_{t}(B_{(t-\triangle t)} e^{r_{max}B_{(t-\triangle t)}(1-\frac{B_{(t-\triangle t)}}{K})}), \sigma_{proc})
\end{equation}

\begin{equation}
    g_{t} \sim N(L_{t} e^{B_{t}}, \sigma_{obs})
\end{equation}


where estimated parameters include $B_{t}$ which is a latent variable representative of photosynthetically-active biomass on a natural log scale and daily time step, $P_{t}$ which is the daily persistence of biomass dependent on hydrologic disturbance and removal detailed above, $K$ which is the estimated carrying capacity of a river, $r_{max}$ is the maximum per capita growth rate when $\frac {B_t}{K}$ approaches zero following a disturbance, $\alpha$ which is a light growth efficiency parameter (units: g $O_2$ $m^{-2}$ $d^{-1}$), and $\sigma_{proc}$ which is the process error.

### Productivity Model 3: Latent biomass Ricker model
We predict the temporal dynamics of mean daily estimates of GPP ($g$) by incorporating biomass as a latent variable and modeling its dynamics using a Ricker growth model. We fit the model to the $g$ times series from Appling et al. (2018) to estimate the model parameters. We incorporated the effects of disturbance by modeling the persistence ($P$) of biomass using a complementary log-log link function of the same form as above.

Together, the full model took the form:

\begin{equation}
    B_{t} \sim N(P_{t}(B_{(t-\Delta t)} + r_{max} + \gamma e^{(B_{(t-\Delta t)})}), \sigma_{proc})
\end{equation}

\begin{equation}
    g_{t} \sim N(L_{t}e^{B_{t}},\sigma_{obs})
\end{equation}


where estimated parameters include $B_{t}$ which is a latent variable representative of photosynthetically-active biomass on a natural log scale and daily time step, $P_{t}$ which is the daily persistence of biomass dependent on hydrologic disturbance and removal detailed above, $K$ which is the estimated carrying capacity of a river, $r_{max}$ is the maximum per capita growth rate when $\frac {B_t}{K}$ approaches zero following a disturbance, $\alpha$ which is a light growth efficiency parameter (units: g $O_2$ $m^{-2}$ $d^{-1}$), and $\sigma_{proc}$ which is the process error.

### Productivity Model 4: Latent biomass Ricker model with light adjustment
We predict the temporal dynamics of mean daily estimates of GPP ($g$) by incorporating biomass as a latent variable and modeling its dynamics using a Ricker growth model. We fit the model to the $g$ times series from Appling et al. (2018) to estimate the model parameters. We incorporated the effects of disturbance by modeling the persistence ($P$) of biomass using a complementary log-log link function of the same form as above.

Together, the full model took the form:

\begin{equation}
    B_{t} \sim N(P_{t}(B_{(t-\Delta t)} + r_{max,t} + \gamma e^{(B_{(t-\Delta t)})}), \sigma_{proc})
\end{equation}

\begin{equation}
    r_{max,t} = \alpha_{0} + \alpha_{1}L_{t}
\end{equation}

\begin{equation}
    g_{t} \sim N(e^{B_{t}},\sigma_{obs})
\end{equation}


where estimated parameters include $B_{t}$ which is a latent variable representative of photosynthetically-active biomass on a natural log scale and daily time step, $P_{t}$ which is the daily persistence of biomass dependent on hydrologic disturbance and removal detailed above, $K$ which is the estimated carrying capacity of a river, $r_{max}$ is the maximum per capita growth rate when $\frac {B_t}{K}$ approaches zero following a disturbance, $\alpha$ which is a light growth efficiency parameter (units: g $O_2$ $m^{-2}$ $d^{-1}$), and $\sigma_{proc}$ which is the process error.

### Productivity Model 5: Gompertz
We predict the temporal dynamics of mean daily estimates of GPP ($g$) by incorporating biomass as a latent variable and modeling its dynamics using a Ricker growth model. We fit the model to the $g$ times series from Appling et al. (2018) to estimate the model parameters. We incorporated the effects of disturbance by modeling the persistence ($P$) of biomass using a complementary log-log link function of the same form as above.

Together, the full model took the form:

\begin{equation}
    B_{t} \sim N(P_{t}(\beta_{0} + \beta_{1}e^{(B_{(t-\Delta t)})} + \beta_{2}L_{t}), \sigma_{proc})
\end{equation}


\begin{equation}
    g_{t} \sim N(e^{B_{t}},\sigma_{obs})
\end{equation}


where estimated parameters include $B_{t}$ which is a latent variable representative of photosynthetically-active biomass on a natural log scale and daily time step, $P_{t}$ which is the daily persistence of biomass dependent on hydrologic disturbance and removal detailed above, $K$ which is the estimated carrying capacity of a river, $r_{max}$ is the maximum per capita growth rate when $\frac {B_t}{K}$ approaches zero following a disturbance, $\alpha$ which is a light growth efficiency parameter (units: g $O_2$ $m^{-2}$ $d^{-1}$), and $\sigma_{proc}$ which is the process error.

